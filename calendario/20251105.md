---
exe-start: 30
exepro-start: 46
---

# Exercizes: functions

::: exefatti

Write a Python program that takes a series of numbers separated by `,` as input, identifies which of those numbers are perfect numbers, and prints their average.
A *perfect number*, according to the Greek mathematician Nicomachus, is defined as a number that equals its aliquot sum. For example: `6` is a perfect number, because it is equal to its aliquot sum: `1 + 2 + 3 = 6`. Same goes for `28`: `1 + 2 + 4 + 7 + 14 = 28`.
*Note*: an aliquot of a number `n` a divisor of `n` that is positive and is not `n` itself.

```python
SEP = ","

def is_perfect(n):
    if n >= 2:
      aliquot_sum = 1

      halfplus1 = n // 2 + 1
      for i in range(2, halfplus1):
          if n % i == 0:
              aliquot_sum += i
      return aliquot_sum == n

    # this is the anomaly, handled at the end
    return False


# MAIN FLOW
in_seq = input("input: ")
in_values = in_seq.split(SEP)
perfect_nums = []
tot = 0
size = 0
for x in in_values:
    int_x = int(x)
    if is_perfect(int_x):
        perfect_nums.append(int_x)
        tot += int_x
        size += 1

avg = tot / size
print("Average:", avg)
```

[file](../codice/30.sub.perfectnumber.py)


:::



::: exefatti

Write a program that asks the user to enter a sequence of words, one per line, until they enter an empty line. For each word, count how many vowels (`a`, `e`, `i`, `o`, `u`) are in the word and return the count. 

```python
STOP = ""

def count_vowels(word):
    count = 0
    for letter in word:
        if letter in "aeiouAEIOU":
            count += 1
    return count

# Input loop
word = input()
while word != STOP:
    num_vowels = count_vowels(word)
    print(f"{word}: {num_vowels} vowels")
    word = input()
```

[file](../codice/31.sub.countvowels.py)

:::

::: exefatti

Write a program that asks the user to enter a sequence of words, one per line, until they enter an empty line. For each word, analyze:

+ How many vowels it contains 
+ Whether it contains consecutive consonants 

Then, classify each word as:

+ "smooth" if it has more than 2 vowels and no consonant cluster
+ "rough" otherwise

Example:
```
- Input -

apple
banana
sky
orange

- Ouput -

You've inserted following words:
apple: rough
strength: rough
banana: smooth
sky: rough
orange: rough
```

```python
STOP = ""
VOWELS = "aeiouAEIOU"
CONSONANTS = "bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ"

def count_vowels(word):
    count = 0
    for letter in word:
        if letter in VOWELS:
            count += 1
    return count

def has_consonant_cluster(word):
    n_chars = len(word)
    for i in range(0,n_chars-1):
        if word[i] in CONSONANTS and word[i+1] in CONSONANTS:
            return True
    return False


def analyze_word(word):
    vowels = count_vowels(word)
    cluster = has_consonant_cluster(word)
    if vowels > 2 and not cluster:
        return "smooth"
    return "rough"


# Input
words_list = []
word = input()
while word != STOP:
    words_list.append(word)
    word = input()

# Output
print("You've inserted the following words:")
for word in words_list:
    result = analyze_word(word)
    print(f"{word}: {result}")

```

[file](../codice/32.sub.analysewords.1.py)


Alternative logic for `has_consonant_cluster()` that uses a flag:

```python
def has_consonant_cluster(word):
    prev_is_consonant = False
    for letter in word:
        if letter in CONSONANTS:
            if prev_is_consonant:
                return True
            prev_is_consonant = True
        else:
            prev_is_consonant = False
    return False
```

[file](../codice/32.sub.analysewords.2.py)

:::


::: exefatti

Write a Python program that takes in input a word from the user. Compute the score that a player would score for that word in a Scrabble game.
The values are the following:

| **letter**                   | **value** |
|------------------------------|-----------|
| A, E, I, O, U, L, N, R, S, T | 1         |
| D, G                         | 2         |
| B, C, M, P                   | 3         |
| F, H, V, W, Y                | 4         |
| K                            | 5         |
| J, X                         | 8         |
| Q, Z                         | 10        |

Example:

```
input: cabbage
output: 14
```

```python
SCORES = {"a": 1, "c": 3, "b": 3, "e": 1, "d": 2, "g": 2, "f": 4, "i": 1, "h": 4, "k": 5, "j": 8, "m": 3, "l": 1, "o": 1, "n": 1, "q": 10, "p": 3, "s": 1,   "r": 1, "u": 1, "t": 1, "w": 4, "v": 4, "y": 4, "x": 8, "z": 10}

def scrabbleScore(word):
    total = 0
    for letter in word:
        total += SCORES[letter]
    return total

word = input("word: ")
print(scrabbleScore(word))
```

[file](../codice/33.sub.scrabble.py)

:::

::: exefatti

Write a Python program that takes in input a sequence of **integer values** concluded when the user inputs a negative value. The program computes the **frequency of each digit** in each number and the overall **average number of digits**. The program prints a unique global horizontal histogram that shows the frequencies for digits that appear at least once, and displays the computed average.

Example:
```
input: 435 9 84931 940394 0 4831 48930 84843 74103 109 718 0 43 37431 3444 10094 11091 -54

output:
0: #########
1: ##########
3: ###########
4: ###############
5: #
7: ###
8: ######
9: ########

average: 3.7058823529411766
```

```python
BASE = 10
SYMBOL = "#"

def eval_digits_frequency(value):
    """Return (freq, ndigits) for the non-negative integer value."""
    freq = [0] * BASE
    digit = value % BASE
    freq[digit] +=1
    ndigits = 1
    value = value // BASE
    while value > 0:
        digit = value % BASE
        freq[digit] +=1
        ndigits += 1
        value = value// BASE

    return freq, ndigits


def display_histogram(freq):
    """Print horizontal histogram lines only for digits with non-zero counts."""
    for d in range(BASE):
        count = freq[d]
        if count > 0:
            print(f"{d}:", SYMBOL * count)


# ---- Main program  ----

# Inputs
seq_values = []
freqs_list = [0] * BASE
total_digits = 0

v = int(input())
while v >=0:
    seq_values.append(v)
    v = int(input())

# Evaluate frequencies for each value
for val in seq_values:
    val_freqs, ndigits = eval_digits_frequency(val)
    total_digits += ndigits
    for i in range(BASE):
        freqs_list[i] += val_freqs[i]


if len(seq_values)==0:
    print("No integers inserted")
else:  
    # Print histogram  
    display_histogram(freqs_list)
    # Calculate and print average number of digits
    average = total_digits / len(seq_values)
    print("Digits average:", average) 

```

[file](../codice/34.sub.frequencyhistogram.py)

:::

## Proposed exercises

::: exepro

A hospital is screening patients for a condition called **TriCheck Illness**. A patient is flagged as “at risk” if all three of the following are true:

1. Temperature is above 37.5C
2. Heart rate is above 100 bpm
3. Oxygen saturation is below 95%

Each reading consists of three space-separated values: temperature, heart rate, and oxygen level.
Write a program that:

+ Accepts one sequence of readings per patient 
+ Typing "stop" ends the input session.
+ For each patient, displays whether they are "at risk"
+ At the end, displays how many patients are "at-risk".


```
Enter reading for patient 1:
38.2 105 94
>> Patient 1 is at risk

Enter reading for patient 2:
37.0 102 96
>> Patient 2: not at risk

Enter reading for patient 3:
stop

>> Total 1/2 patients at risk

```

```python

def is_at_risk(temp, heart_rate, oxygen):
    return temp > 37.5 and heart_rate > 100 and oxygen < 95


# Main program
at_risk_patients = 0
tot_patients = 0

STOP = 'stop'
print(f"Type '{STOP}' to end.\n")

line = input(f"Enter readings for patient {tot_patients + 1}:\n")
while line.strip().lower() != STOP:

    # get values
    parts = line.split()
    temp = float(parts[0])
    heart = int(parts[1])
    oxygen = int(parts[2])

    if is_at_risk(temp, heart, oxygen):
        print(f">> Patient {patient_index} is at risk\n")
        at_risk_patients += 1
    else:
        print(f">> Patient {patient_index}: not at risk\n")
    
    tot_patients += 1
    line = input(f"Enter readings for patient {tot_patients + 1}:\n")

print(f">> Total {at_risk_patients}/{tot_patients} patients at risk")

```

[file](../codice/90.sub.patients.py)

:::

::: exepro
Write a Python function that given a decimal number `n` (positive) as integer, computes its corresponding Binary-Coded Decimal (BCD code) string and returns it (see below). 

:::


::: exepro

Write a Python function that given a list of positive integers creates and returns a new list where each element is computed as the greatest element preceeding the element in the list which is strictly smaller than itself; if this element does not exist the value in the new list is -1.

Example:

```
input: [2, 3, 4, 5, 1]
output: [-1, 2, 3, 4, -1]
```
:::




### BCD Code

The BCD code (Binary-Coded Decimal) is based on encoding the ten decimal digits using natural binary coding, and on their juxtaposition for representing values. More precisely, since the digits to be represented are `{0, 1, ..., 9}`, it is necessary to use 4 bits.

| Decimal Digit | BCD Code |
| ------------- | -------- |
| 0             | 0000     |
| 1             | 0001     |
| 2             | 0010     |
| 3             | 0011     |
| 4             | 0100     |
| 5             | 0101     |
| 6             | 0110     |
| 7             | 0111     |
| 8             | 1000     |
| 9             | 1001     |


If we want to represent the numerical value 25 expressed in base 10 into the BCD code, we juxtapose the encoding of the digit `2`\_10 = `0010`\_BCD with that of `5`\_10 = `0101`\_BCD, obtaining `00100101`\_BCD.

Although this code may seem inefficient, since it requires manipulation of individual digits, it is useful for representing rational values with a fixed number of decimal digits, where no approximation can be tolerated.